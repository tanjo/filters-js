(function(){var t;t=function(t){var e,a,n,r,i,d,h,o,c,g,f,u,m,l,I,w,v,p,s,E,D,y,M,k,B,L,x,_,b,z,R,U,A,C,F,j,q,G,H,J,K,N,O,P,Q,S,T,V,W,X,Y,Z,$,tt,et,at,nt,rt,it,dt,ht,ot;i=document.getElementById("result"),g=i.getContext("2d"),i.width=t.width,i.height=t.height,g.drawImage(t,0,0,t.width,t.height),t.style.display="none",j=g.getImageData(0,0,i.width,i.height),f=j.data,nt=function(){var t,e;return window.open(i.toDataURL("image/png")),e=i.toDataURL("png"),t=document.createElement("a"),t.href=e,t.download="image.png",t.click()},rt=document.getElementById("save"),rt.disabled=null,rt.addEventListener("click",nt),Q=function(){g.putImageData(j,0,0)},S=document.getElementById("original"),S.addEventListener("click",Q),U=function(){var t,e,a,n,r,i;for(n=g.createImageData(j.width,j.height),r=n.data,e=a=0,i=f.length;a<i;e=a+=4)t=(f[e]+f[e+1]+f[e+2])/3,r[e]=t,r[e+1]=t,r[e+2]=t,r[e+3]=f[e+3];return g.putImageData(n,0,0),n},A=document.getElementById("grayscale"),A.addEventListener("click",U),u=function(){var t,e,a,n,r,i,d,h,o,c,u,m,l,I,w,v,p,s,E,D;for(l=g.createImageData(j.width,j.height),I=l.data,d=[-1,-1,0,-1,1,1,0,1,1],D=o=1,v=j.height-1;1<=v?o<v:o>v;D=1<=v?++o:--o)for(E=c=1,p=j.width-1;1<=p?c<p:c>p;E=1<=p?++c:--c){for(e=u=0;u<3;e=++u){for(i=4*(D*j.width+E)+e,s=0,r=m=-1;m<=1;r=++m)for(n=w=-1;w<=1;n=++w)h=3*(r+1)+(n+1),a=4*((D+r)*j.width+(E+n))+e,s+=d[h]*f[a];s>255&&(I[i]=255),s<0?I[i]=0:I[i]=s}t=4*(D*j.width+E)+3,I[t]=f[t]}g.putImageData(l,0,0)},m=document.getElementById("emboss"),m.addEventListener("click",u),it=function(){var t,e,a,n,r,i,d,h,o,c,u,m,l,I,w,v,p,s,E,D;for(l=g.createImageData(j.width,j.height),I=l.data,d=[0,-1,0,-1,5,-1,0,-1,0],D=o=1,v=j.height-1;1<=v?o<v:o>v;D=1<=v?++o:--o)for(E=c=1,p=j.width-1;1<=p?c<p:c>p;E=1<=p?++c:--c){for(e=u=0;u<3;e=++u){for(i=4*(D*j.width+E)+e,s=0,r=m=-1;m<=1;r=++m)for(n=w=-1;w<=1;n=++w)h=3*(r+1)+(n+1),a=4*((D+r)*j.width+(E+n))+e,s+=d[h]*f[a];s>255&&(I[i]=255),s<0?I[i]=0:I[i]=s}t=4*(D*j.width+E)+3,I[t]=f[t]}g.putImageData(l,0,0)},dt=document.getElementById("sharp"),dt.addEventListener("click",it),O=function(){var t,e,a,n,r;for(a=g.createImageData(j.width,j.height),n=a.data,t=e=0,r=f.length;e<r;t=e+=4)n[t]=255-f[t],n[t+1]=255-f[t+1],n[t+2]=255-f[t+2],n[t+3]=f[t+3];g.putImageData(a,0,0)},P=document.getElementById("negative"),P.addEventListener("click",O),d=function(){var t,e,a,n,r,i;for(t=function(t){var e;return e=1.5,e*(t-127)+127},n=g.createImageData(j.width,j.height),r=n.data,e=a=0,i=f.length;a<i;e=a+=4)r[e]=t(f[e]),r[e+1]=t(f[e+1]),r[e+2]=t(f[e+2]),r[e+3]=f[e+3];g.putImageData(n,0,0)},h=document.getElementById("contrast_enhancement"),h.addEventListener("click",d),o=function(){var t,e,a,n,r,i;for(t=function(t){var e;return e=.5,e*(t-127)+127},n=g.createImageData(j.width,j.height),r=n.data,e=a=0,i=f.length;a<i;e=a+=4)r[e]=t(f[e]),r[e+1]=t(f[e+1]),r[e+2]=t(f[e+2]),r[e+3]=f[e+3];g.putImageData(n,0,0)},c=document.getElementById("contrast_reduction"),c.addEventListener("click",o),z=function(){var t,e,a,n,r,i,d,h,o,c,u,m,l,I,w,v,p,s,E,D;for(l=g.createImageData(j.width,j.height),I=l.data,d=[.00390625,.015625,.0234375,.015625,.00390625,.015625,.0625,.09375,.0625,.015625,.0234375,.09375,.140625,.09375,.0234375,.015625,.0625,.09375,.0625,.015625,.00390625,.015625,.0234375,.015625,.00390625],D=o=2,v=j.height-2;2<=v?o<v:o>v;D=2<=v?++o:--o)for(E=c=2,p=j.width-2;2<=p?c<p:c>p;E=2<=p?++c:--c){for(e=u=0;u<3;e=++u){for(i=4*(D*j.width+E)+e,s=0,r=m=-2;m<=2;r=++m)for(n=w=-2;w<=2;n=++w)h=5*(r+2)+(n+2),a=4*((D+r)*j.width+(E+n))+e,s+=d[h]*f[a];s>255&&(I[i]=255),s<0?I[i]=0:I[i]=s}t=4*(D*j.width+E)+3,I[t]=f[t]}g.putImageData(l,0,0)},R=document.getElementById("gaussian_filter"),R.addEventListener("click",z),ht=function(){var t,e,a,n,r,i,d,h,o,c,u,m,l,I,w,v,p,s,E,D;for(l=g.createImageData(j.width,j.height),I=l.data,d=[-1,0,1,-2,0,2,-1,0,1],D=o=1,v=j.height-1;1<=v?o<v:o>v;D=1<=v?++o:--o)for(E=c=1,p=j.width-1;1<=p?c<p:c>p;E=1<=p?++c:--c){for(e=u=0;u<3;e=++u){for(i=4*(D*j.width+E)+e,s=0,r=m=-1;m<=1;r=++m)for(n=w=-1;w<=1;n=++w)h=3*(r+1)+(n+1),a=4*((D+r)*j.width+(E+n))+e,s+=d[h]*f[a];s>255&&(I[i]=255),s<0?I[i]=0:I[i]=s}t=4*(D*j.width+E)+3,I[t]=f[t]}g.putImageData(l,0,0)},ot=document.getElementById("sobel_filter"),ot.addEventListener("click",ht),H=function(){var t,e,a,n,r,i,d,h,o,c,u,m,l,I,w,v,p,s,E,D;for(l=g.createImageData(j.width,j.height),I=l.data,d=[1,1,1,1,-8,1,1,1,1],D=o=1,v=j.height-1;1<=v?o<v:o>v;D=1<=v?++o:--o)for(E=c=1,p=j.width-1;1<=p?c<p:c>p;E=1<=p?++c:--c){for(e=u=0;u<3;e=++u){for(i=4*(D*j.width+E)+e,s=0,r=m=-1;m<=1;r=++m)for(n=w=-1;w<=1;n=++w)h=3*(r+1)+(n+1),a=4*((D+r)*j.width+(E+n))+e,s+=d[h]*f[a];s>255&&(I[i]=255),s<0?I[i]=0:I[i]=s}t=4*(D*j.width+E)+3,I[t]=f[t]}g.putImageData(l,0,0)},J=document.getElementById("laplacian_filter"),J.addEventListener("click",H),W=function(){var t,e,a,n,r,i,d,h,o,c,u,m,l,I,w,v,p,s,E;for(o=g.createImageData(j.width,j.height),c=o.data,s=r=0,l=j.height-2;r<l;s=r+=5)for(v=i=0,I=j.width-2;i<I;v=i+=5){for(w=[0,0,0,0],t=0,a=d=0;d<=4;a=++d)for(e=h=0;h<=4;e=++h)E=s+a,p=v+e,p<j.width&&E<j.height&&(t+=1,n=4*(E*j.width+p),w[0]+=f[n],w[1]+=f[n+1],w[2]+=f[n+2],w[3]+=f[n+3]);for(a=u=0;u<=4;a=++u)for(e=m=0;m<=4;e=++m)E=s+a,p=v+e,p<j.width&&E<j.height&&(n=4*(E*j.width+p),c[n]=w[0]/t,c[n+1]=w[1]/t,c[n+2]=w[2]/t,c[n+3]=w[3]/t)}g.putImageData(o,0,0)},X=document.getElementById("pixelization"),X.addEventListener("click",W),Y=function(){var t,e,a,n,r,i,d,h,o,c,u,m,l,I,w,v,p,s,E;for(o=g.createImageData(j.width,j.height),c=o.data,s=r=0,l=j.height-7;r<l;s=r+=15)for(v=i=0,I=j.width-7;i<I;v=i+=15){for(w=[0,0,0,0],t=0,a=d=0;d<=14;a=++d)for(e=h=0;h<=14;e=++h)E=s+a,p=v+e,p<j.width&&E<j.height&&(t+=1,n=4*(E*j.width+p),w[0]+=f[n],w[1]+=f[n+1],w[2]+=f[n+2],w[3]+=f[n+3]);for(a=u=0;u<=14;a=++u)for(e=m=0;m<=14;e=++m)E=s+a,p=v+e,p<j.width&&E<j.height&&(n=4*(E*j.width+p),c[n]=w[0]/t,c[n+1]=w[1]/t,c[n+2]=w[2]/t,c[n+3]=w[3]/t)}g.putImageData(o,0,0)},Z=document.getElementById("pixelization_hard"),Z.addEventListener("click",Y),e=function(){var t,e,a,n,r,i;for(n=g.createImageData(j.width,j.height),r=n.data,t=127,e=a=0,i=f.length;a<i;e=a+=4)r[e]=f[e]>t?255:0,r[e+1]=f[e+1]>t?255:0,r[e+2]=f[e+2]>t?255:0,r[e+3]=f[e+3];g.putImageData(n,0,0)},a=document.getElementById("binarization"),a.addEventListener("click",e),T=function(){var t,e,a,n,r,i,d,h,o,c,f,u;for(h=U(),o=h.data,e=function(){var t,e;for(e=[],t=1;t<=256;t++)e.push(0);return e}(),a=n=0,c=o.length;n<c;a=n+=4)e[o[a]]+=1;for(i=h.width*h.height/2,t=0,u=0,a=r=255;r>=0;a=--r)if(t+=e[a],t>=i){u=a;break}for(a=d=0,f=o.length;d<f;a=d+=4)o[a]=o[a]>u?255:0,o[a+1]=o[a+1]>u?255:0,o[a+2]=o[a+2]>u?255:0,o[a+3]=o[a+3];g.putImageData(h,0,0)},V=document.getElementById("percentile_method"),V.addEventListener("click",T),l=function(){var t,e,a,n,r,i;for(n=g.createImageData(j.width,j.height),r=n.data,t=[.73412,.647019,.07914],e=a=0,i=f.length;a<i;e=a+=4)r[e]=255/(1+Math.exp(t[0]*(127-f[e]))),r[e+1]=255/(1+Math.exp(t[1]*(127-f[e+1]))),r[e+2]=255/(1+Math.exp(t[2]*(127-f[e+2]))),r[e+3]=f[e+3];return g.putImageData(n,0,0),n},I=document.getElementById("filter1"),I.addEventListener("click",l),w=function(){var t,e,a,n,r,i;for(n=g.createImageData(j.width,j.height),r=n.data,t=[.073412,.0647019,.07914],e=a=0,i=f.length;a<i;e=a+=4)r[e]=255/(1+Math.exp(t[0]*(127-f[e]))),r[e+1]=255/(1+Math.exp(t[1]*(127-f[e+1]))),r[e+2]=255/(1+Math.exp(t[2]*(127-f[e+2]))),r[e+3]=f[e+3];return g.putImageData(n,0,0),n},v=document.getElementById("filter2"),v.addEventListener("click",w),p=function(){var t,e,a,n,r,i;for(n=g.createImageData(j.width,j.height),r=n.data,t=[.9,0,.5],e=a=0,i=f.length;a<i;e=a+=4)r[e]=255/(1+Math.exp(t[0]*(127-f[e]))),r[e+1]=255/(1+Math.exp(t[1]*(127-f[e+1]))),r[e+2]=255/(1+Math.exp(t[2]*(127-f[e+2]))),r[e+3]=f[e+3];return g.putImageData(n,0,0),n},s=document.getElementById("filter3"),s.addEventListener("click",p),E=function(){var t,e,a,n,r,i;for(n=g.createImageData(j.width,j.height),r=n.data,t=[.373412,.347019,.3914],e=a=0,i=f.length;a<i;e=a+=4)r[e]=255/(1+Math.exp(t[0]*(127-f[e]))),r[e+1]=255/(1+Math.exp(t[1]*(127-f[e+1]))),r[e+2]=255/(1+Math.exp(t[2]*(127-f[e+2]))),r[e+3]=f[e+3];return g.putImageData(n,0,0),n},D=document.getElementById("filter4"),D.addEventListener("click",E),y=function(){var t,e,a,n,r,i;for(n=g.createImageData(j.width,j.height),r=n.data,t=[.0073412,.647019,.7914],e=a=0,i=f.length;a<i;e=a+=4)r[e]=255/(1+Math.exp(t[0]*(127-f[e]))),r[e+1]=255/(1+Math.exp(t[1]*(127-f[e+1]))),r[e+2]=255/(1+Math.exp(t[2]*(127-f[e+2]))),r[e+3]=f[e+3];return g.putImageData(n,0,0),n},M=document.getElementById("filter5"),M.addEventListener("click",y),k=function(){var t,e,a,n,r,i;for(n=g.createImageData(j.width,j.height),r=n.data,t=[.93412,.647019,.0057914],e=a=0,i=f.length;a<i;e=a+=4)r[e]=255/(1+Math.exp(t[0]*(127-f[e]))),r[e+1]=255/(1+Math.exp(t[1]*(127-f[e+1]))),r[e+2]=255/(1+Math.exp(t[2]*(127-f[e+2]))),r[e+3]=f[e+3];return g.putImageData(n,0,0),n},B=document.getElementById("filter6"),B.addEventListener("click",k),$=function(t){var e,a,n,r,i,d,h,o,c,u,m,l,I,w,v,p,s,E,D,y,M,k,B,L,x,_,b,z,R,U,A,C,F;for(null==t&&(t=5),p=g.createImageData(j.width,j.height),s=p.data,C=t,w=256/C,d=255/(C-1),n=function(){var t,e;for(e=[],t=1;t<=256;t++)e.push(0);return e}(),h=c=0,y=C;0<=y?c<y:c>y;h=0<=y?++c:--c)for(o=u=M=Math.floor(h*w),k=Math.floor((h+1)*w);M<=k?u<k:u>k;o=M<=k?++u:--u)n[o]=d*h;for(A=t,I=256/A,i=255/(A-1),a=function(){var t,e;for(e=[],t=1;t<=256;t++)e.push(0);return e}(),h=m=0,B=A;0<=B?m<B:m>B;h=0<=B?++m:--m)for(o=v=L=Math.floor(h*I),x=Math.floor((h+1)*I);L<=x?v<x:v>x;o=L<=x?++v:--v)a[o]=i*h;for(U=t,l=256/U,r=255/(U-1),e=function(){var t,e;for(e=[],t=1;t<=256;t++)e.push(0);return e}(),h=E=0,_=U;0<=_?E<_:E>_;h=0<=_?++E:--E)for(o=D=b=Math.floor(h*l),z=Math.floor((h+1)*l);b<=z?D<z:D>z;o=b<=z?++D:--D)e[o]=r*h;for(h=F=0,R=f.length;F<R;h=F+=4)s[h]=n[f[h]],s[h+1]=a[f[h+1]],s[h+2]=e[f[h+2]],s[h+3]=f[h+3];return g.putImageData(p,0,0),p},tt=document.getElementById("posterization"),tt.addEventListener("click",$),K=function(){var t,e,a,n,r,i,d,h,o,c,u,m,l,I,w,v,p;for(o=g.createImageData(j.width,j.height),c=o.data,p=r=1,u=j.height-1;1<=u?r<u:r>u;p=1<=u?++r:--r)for(v=i=1,m=j.width-1;1<=m?i<m:i>m;v=1<=m?++i:--i){for(n=4*(p*j.width+v),w=[],I=[],l=[],a=d=-1;d<=1;a=++d)for(e=h=-1;h<=1;e=++h)t=4*((p+a)*j.width+(v+e)),w.push(f[t]),I.push(f[t+1]),l.push(f[t+2]);w.sort(function(t,e){return t>e?-1:t<e?1:0}),I.sort(function(t,e){return t>e?-1:t<e?1:0}),l.sort(function(t,e){return t>e?-1:t<e?1:0}),c[n]=w[4],c[n+1]=I[4],c[n+2]=l[4],c[n+3]=f[n+3]}return g.putImageData(o,0,0),o},N=document.getElementById("median_filter"),N.addEventListener("click",K),q=function(){var t,e,a,n,r,i,d,h,o,c,u,m,l,I,w,v,p,s,E,D,y,M,k,B,L;for(v=$(64),p=v.data,L=o=2,E=j.height-2;2<=E?o<E:o>E;L=2<=E?++o:--o)for(B=c=2,D=j.width-2;2<=D?c<D:c>D;B=2<=D?++c:--c){for(d=4*(L*j.width+B),i=function(){var t,e;for(e=[],t=1;t<=256;t++)e.push(0);return e}(),r=function(){var t,e;for(e=[],t=1;t<=256;t++)e.push(0);return e}(),n=function(){var t,e;for(e=[],t=1;t<=256;t++)e.push(0);return e}(),a=I=-2;I<=2;a=++I)for(e=w=-2;w<=2;e=++w)t=4*((L+a)*j.width+(B+e)),i[f[t]]+=1,r[f[t+1]]+=1,n[f[t+2]]+=1;for(l=0,m=0,u=0,k=0,M=0,y=0,h=s=0;s<=255;h=++s)l<i[h]&&(l=i[h],k=h),m<r[h]&&(m=r[h],M=h),u<n[h]&&(u=n[h],y=h);p[d]=k,p[d+1]=M,p[d+2]=y,p[d+3]=f[d+3]}return g.putImageData(v,0,0),v},G=document.getElementById("kaiga"),G.addEventListener("click",q),L=function(){var t,e,a,n,r,i,d,h,o,c,u,m,l,I,w,v,p,s,E;for(m=g.createImageData(j.width,j.height),l=m.data,t=[1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9],E=h=2,w=j.height;2<=w?h<w:h>w;E=2<=w?++h:--h)for(s=o=2,v=j.width;2<=v?o<v:o>v;s=2<=v?++o:--o){for(i=4*(E*j.width+s),p=[0,0,0],r=c=-2;c<=0;r=++c)for(n=u=-2;u<=0;n=++u)for(d=3*(r+2)+(n+2),a=4*((E+r)*j.width+(s+n)),e=I=0;I<3;e=++I)p[e]+=f[a+e]*t[d];l[i]=p[0],l[i+1]=p[1],l[i+2]=p[2],l[i+3]=f[i+3]}return g.putImageData(m,0,0),m},x=document.getElementById("fir_filter"),x.addEventListener("click",L),_=function(){var t,e,a,n,r,i;for(n=U(),r=n.data,a=255,_=1.5,t=e=0,i=r.length;e<i;t=e+=4)r[t]=a*Math.pow(f[t]/a,1/_),r[t+1]=a*Math.pow(f[t+1]/a,1/_),r[t+2]=a*Math.pow(f[t+2]/a,1/_),r[t+3]=r[t+3];g.putImageData(n,0,0)},b=document.getElementById("gamma"),b.addEventListener("click",_),et=function(){var t,e,a,n,r,i,d,h,o,c,u;for(h=U(),o=h.data,n=r=0,u=f.length;r<u;n=r+=4){for(c=f[n],e=f[n+1],t=f[n+2],i=Math.max(c,e,t),d=Math.min(c,e,t),c===e&&c===t?a=0:c>=e&&c>=t?a=60*((e-t)/(i-d)):e>=c&&e>=t?a=60*((t-c)/(i-d))+120:t>=c&&t>=e&&(a=60*((c-e)/(i-d))+240);a<0;)a+=360;(a<=30||a>=300)&&(o[n]=c,o[n+1]=e,o[n+2]=t)}return g.putImageData(h,0,0),h},at=document.getElementById("red"),at.addEventListener("click",et),C=function(){var t,e,a,n,r,i,d,h,o,c,u;for(h=U(),o=h.data,n=r=0,u=f.length;r<u;n=r+=4){for(c=f[n],e=f[n+1],t=f[n+2],i=Math.max(c,e,t),d=Math.min(c,e,t),c===e&&c===t?a=0:c>=e&&c>=t?a=60*((e-t)/(i-d)):e>=c&&e>=t?a=60*((t-c)/(i-d))+120:t>=c&&t>=e&&(a=60*((c-e)/(i-d))+240);a<0;)a+=360;a<=180&&a>=30&&(o[n]=c,o[n+1]=e,o[n+2]=t)}return g.putImageData(h,0,0),h},F=document.getElementById("green"),F.addEventListener("click",C),n=function(){var t,e,a,n,r,i,d,h,o,c,u;for(h=U(),o=h.data,n=r=0,u=f.length;r<u;n=r+=4){for(c=f[n],e=f[n+1],t=f[n+2],i=Math.max(c,e,t),d=Math.min(c,e,t),c===e&&c===t?a=0:c>=e&&c>=t?a=60*((e-t)/(i-d)):e>=c&&e>=t?a=60*((t-c)/(i-d))+120:t>=c&&t>=e&&(a=60*((c-e)/(i-d))+240);a<0;)a+=360;a<=300&&a>=180&&(o[n]=c,o[n+1]=e,o[n+2]=t)}return g.putImageData(h,0,0),h},r=document.getElementById("blue"),r.addEventListener("click",n)},window.onload=function(){var e,a;e=document.getElementById("preview"),a=document.getElementById("getfile"),a.onchange=function(){var e,n;e=new Image,e.onload=function(){t(this)},n=new FileReader,n.onload=function(){return e.src=n.result},n.readAsDataURL(a.files[0])}}}).call(this);
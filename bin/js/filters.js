(function(){var t;t=function(t){var e,a,n,r,i,o,d,h,c,f,u,g,m,l,I,p,v,w,s,E,D,M,y,k,B,L,x,_,b,z,R,U,A,C,F,j,q,G,H,J,K,N,O,P,Q,S,T,V,W,X,Y,Z,$,tt,et,at,nt,rt,it,ot,dt,ht,ct,ft;i=document.getElementById("result"),f=i.getContext("2d"),i.width=t.width,i.height=t.height,f.drawImage(t,0,0,t.width,t.height),t.style.display="none",j=f.getImageData(0,0,i.width,i.height),u=j.data,nt=function(){var t,e;return window.open(i.toDataURL("image/png")),e=i.toDataURL("png"),t=document.createElement("a"),t.href=e,t.download="image.png",t.click()},rt=document.getElementById("save"),rt.disabled=null,rt.addEventListener("click",nt),Q=function(){f.putImageData(j,0,0)},S=document.getElementById("original"),S.addEventListener("click",Q),U=function(){var t,e,a,n,r,i;for(n=f.createImageData(j.width,j.height),r=n.data,e=a=0,i=u.length;a<i;e=a+=4)t=(u[e]+u[e+1]+u[e+2])/3,r[e]=t,r[e+1]=t,r[e+2]=t,r[e+3]=u[e+3];return f.putImageData(n,0,0),n},A=document.getElementById("grayscale"),A.addEventListener("click",U),g=function(){var t,e,a,n,r,i,o,d,h,c,g,m,l,I,p,v,w,s,E,D;for(l=f.createImageData(j.width,j.height),I=l.data,o=[-1,-1,0,-1,1,1,0,1,1],D=h=1,v=j.height-1;1<=v?h<v:h>v;D=1<=v?++h:--h)for(E=c=1,w=j.width-1;1<=w?c<w:c>w;E=1<=w?++c:--c){for(e=g=0;g<3;e=++g){for(i=4*(D*j.width+E)+e,s=0,r=m=-1;m<=1;r=++m)for(n=p=-1;p<=1;n=++p)d=3*(r+1)+(n+1),a=4*((D+r)*j.width+(E+n))+e,s+=o[d]*u[a];s>255&&(I[i]=255),s<0?I[i]=0:I[i]=s}t=4*(D*j.width+E)+3,I[t]=u[t]}f.putImageData(l,0,0)},m=document.getElementById("emboss"),m.addEventListener("click",g),it=function(){var t,e,a,n,r,i,o,d,h,c,g,m,l,I,p,v,w,s,E,D;for(l=f.createImageData(j.width,j.height),I=l.data,o=[0,-1,0,-1,5,-1,0,-1,0],D=h=1,v=j.height-1;1<=v?h<v:h>v;D=1<=v?++h:--h)for(E=c=1,w=j.width-1;1<=w?c<w:c>w;E=1<=w?++c:--c){for(e=g=0;g<3;e=++g){for(i=4*(D*j.width+E)+e,s=0,r=m=-1;m<=1;r=++m)for(n=p=-1;p<=1;n=++p)d=3*(r+1)+(n+1),a=4*((D+r)*j.width+(E+n))+e,s+=o[d]*u[a];s>255&&(I[i]=255),s<0?I[i]=0:I[i]=s}t=4*(D*j.width+E)+3,I[t]=u[t]}f.putImageData(l,0,0)},ot=document.getElementById("sharp"),ot.addEventListener("click",it),O=function(){var t,e,a,n,r;for(a=f.createImageData(j.width,j.height),n=a.data,t=e=0,r=u.length;e<r;t=e+=4)n[t]=255-u[t],n[t+1]=255-u[t+1],n[t+2]=255-u[t+2],n[t+3]=u[t+3];f.putImageData(a,0,0)},P=document.getElementById("negative"),P.addEventListener("click",O),o=function(){var t,e,a,n,r,i;for(t=function(t){var e;return e=1.5,e*(t-127)+127},n=f.createImageData(j.width,j.height),r=n.data,e=a=0,i=u.length;a<i;e=a+=4)r[e]=t(u[e]),r[e+1]=t(u[e+1]),r[e+2]=t(u[e+2]),r[e+3]=u[e+3];f.putImageData(n,0,0)},d=document.getElementById("contrast_enhancement"),d.addEventListener("click",o),h=function(){var t,e,a,n,r,i;for(t=function(t){var e;return e=.5,e*(t-127)+127},n=f.createImageData(j.width,j.height),r=n.data,e=a=0,i=u.length;a<i;e=a+=4)r[e]=t(u[e]),r[e+1]=t(u[e+1]),r[e+2]=t(u[e+2]),r[e+3]=u[e+3];f.putImageData(n,0,0)},c=document.getElementById("contrast_reduction"),c.addEventListener("click",h),z=function(){var t,e,a,n,r,i,o,d,h,c,g,m,l,I,p,v,w,s,E,D;for(l=f.createImageData(j.width,j.height),I=l.data,o=[.00390625,.015625,.0234375,.015625,.00390625,.015625,.0625,.09375,.0625,.015625,.0234375,.09375,.140625,.09375,.0234375,.015625,.0625,.09375,.0625,.015625,.00390625,.015625,.0234375,.015625,.00390625],D=h=2,v=j.height-2;2<=v?h<v:h>v;D=2<=v?++h:--h)for(E=c=2,w=j.width-2;2<=w?c<w:c>w;E=2<=w?++c:--c){for(e=g=0;g<3;e=++g){for(i=4*(D*j.width+E)+e,s=0,r=m=-2;m<=2;r=++m)for(n=p=-2;p<=2;n=++p)d=5*(r+2)+(n+2),a=4*((D+r)*j.width+(E+n))+e,s+=o[d]*u[a];s>255&&(I[i]=255),s<0?I[i]=0:I[i]=s}t=4*(D*j.width+E)+3,I[t]=u[t]}f.putImageData(l,0,0)},R=document.getElementById("gaussian_filter"),R.addEventListener("click",z),ct=function(){var t,e,a,n,r,i,o,d,h,c,g,m,l,I,p,v,w,s,E,D;for(l=f.createImageData(j.width,j.height),I=l.data,o=[-1,0,1,-2,0,2,-1,0,1],D=h=1,v=j.height-1;1<=v?h<v:h>v;D=1<=v?++h:--h)for(E=c=1,w=j.width-1;1<=w?c<w:c>w;E=1<=w?++c:--c){for(e=g=0;g<3;e=++g){for(i=4*(D*j.width+E)+e,s=0,r=m=-1;m<=1;r=++m)for(n=p=-1;p<=1;n=++p)d=3*(r+1)+(n+1),a=4*((D+r)*j.width+(E+n))+e,s+=o[d]*u[a];s>255&&(I[i]=255),s<0?I[i]=0:I[i]=s}t=4*(D*j.width+E)+3,I[t]=u[t]}f.putImageData(l,0,0)},ft=document.getElementById("sobel_filter"),ft.addEventListener("click",ct),H=function(){var t,e,a,n,r,i,o,d,h,c,g,m,l,I,p,v,w,s,E,D;for(l=f.createImageData(j.width,j.height),I=l.data,o=[1,1,1,1,-8,1,1,1,1],D=h=1,v=j.height-1;1<=v?h<v:h>v;D=1<=v?++h:--h)for(E=c=1,w=j.width-1;1<=w?c<w:c>w;E=1<=w?++c:--c){for(e=g=0;g<3;e=++g){for(i=4*(D*j.width+E)+e,s=0,r=m=-1;m<=1;r=++m)for(n=p=-1;p<=1;n=++p)d=3*(r+1)+(n+1),a=4*((D+r)*j.width+(E+n))+e,s+=o[d]*u[a];s>255&&(I[i]=255),s<0?I[i]=0:I[i]=s}t=4*(D*j.width+E)+3,I[t]=u[t]}f.putImageData(l,0,0)},J=document.getElementById("laplacian_filter"),J.addEventListener("click",H),W=function(){var t,e,a,n,r,i,o,d,h,c,g,m,l,I,p,v,w,s,E;for(h=f.createImageData(j.width,j.height),c=h.data,s=r=0,l=j.height-2;r<l;s=r+=5)for(v=i=0,I=j.width-2;i<I;v=i+=5){for(p=[0,0,0,0],t=0,a=o=0;o<=4;a=++o)for(e=d=0;d<=4;e=++d)E=s+a,w=v+e,w<j.width&&E<j.height&&(t+=1,n=4*(E*j.width+w),p[0]+=u[n],p[1]+=u[n+1],p[2]+=u[n+2],p[3]+=u[n+3]);for(a=g=0;g<=4;a=++g)for(e=m=0;m<=4;e=++m)E=s+a,w=v+e,w<j.width&&E<j.height&&(n=4*(E*j.width+w),c[n]=p[0]/t,c[n+1]=p[1]/t,c[n+2]=p[2]/t,c[n+3]=p[3]/t)}f.putImageData(h,0,0)},X=document.getElementById("pixelization"),X.addEventListener("click",W),Y=function(){var t,e,a,n,r,i,o,d,h,c,g,m,l,I,p,v,w,s,E;for(h=f.createImageData(j.width,j.height),c=h.data,s=r=0,l=j.height-7;r<l;s=r+=15)for(v=i=0,I=j.width-7;i<I;v=i+=15){for(p=[0,0,0,0],t=0,a=o=0;o<=14;a=++o)for(e=d=0;d<=14;e=++d)E=s+a,w=v+e,w<j.width&&E<j.height&&(t+=1,n=4*(E*j.width+w),p[0]+=u[n],p[1]+=u[n+1],p[2]+=u[n+2],p[3]+=u[n+3]);for(a=g=0;g<=14;a=++g)for(e=m=0;m<=14;e=++m)E=s+a,w=v+e,w<j.width&&E<j.height&&(n=4*(E*j.width+w),c[n]=p[0]/t,c[n+1]=p[1]/t,c[n+2]=p[2]/t,c[n+3]=p[3]/t)}f.putImageData(h,0,0)},Z=document.getElementById("pixelization_hard"),Z.addEventListener("click",Y),e=function(){var t,e,a,n,r,i;for(n=f.createImageData(j.width,j.height),r=n.data,t=127,e=a=0,i=u.length;a<i;e=a+=4)r[e]=u[e]>t?255:0,r[e+1]=u[e+1]>t?255:0,r[e+2]=u[e+2]>t?255:0,r[e+3]=u[e+3];f.putImageData(n,0,0)},a=document.getElementById("binarization"),a.addEventListener("click",e),T=function(){var t,e,a,n,r,i,o,d,h,c,u,g;for(d=U(),h=d.data,e=function(){var t,e;for(e=[],t=1;t<=256;t++)e.push(0);return e}(),a=n=0,c=h.length;n<c;a=n+=4)e[h[a]]+=1;for(i=d.width*d.height/2,t=0,g=0,a=r=255;r>=0;a=--r)if(t+=e[a],t>=i){g=a;break}for(a=o=0,u=h.length;o<u;a=o+=4)h[a]=h[a]>g?255:0,h[a+1]=h[a+1]>g?255:0,h[a+2]=h[a+2]>g?255:0,h[a+3]=h[a+3];f.putImageData(d,0,0)},V=document.getElementById("percentile_method"),V.addEventListener("click",T),l=function(){var t,e,a,n,r,i;for(n=f.createImageData(j.width,j.height),r=n.data,t=[.73412,.647019,.07914],e=a=0,i=u.length;a<i;e=a+=4)r[e]=255/(1+Math.exp(t[0]*(127-u[e]))),r[e+1]=255/(1+Math.exp(t[1]*(127-u[e+1]))),r[e+2]=255/(1+Math.exp(t[2]*(127-u[e+2]))),r[e+3]=u[e+3];return f.putImageData(n,0,0),n},I=document.getElementById("filter1"),I.addEventListener("click",l),p=function(){var t,e,a,n,r,i;for(n=f.createImageData(j.width,j.height),r=n.data,t=[.073412,.0647019,.07914],e=a=0,i=u.length;a<i;e=a+=4)r[e]=255/(1+Math.exp(t[0]*(127-u[e]))),r[e+1]=255/(1+Math.exp(t[1]*(127-u[e+1]))),r[e+2]=255/(1+Math.exp(t[2]*(127-u[e+2]))),r[e+3]=u[e+3];return f.putImageData(n,0,0),n},v=document.getElementById("filter2"),v.addEventListener("click",p),w=function(){var t,e,a,n,r,i;for(n=f.createImageData(j.width,j.height),r=n.data,t=[.9,0,.5],e=a=0,i=u.length;a<i;e=a+=4)r[e]=255/(1+Math.exp(t[0]*(127-u[e]))),r[e+1]=255/(1+Math.exp(t[1]*(127-u[e+1]))),r[e+2]=255/(1+Math.exp(t[2]*(127-u[e+2]))),r[e+3]=u[e+3];return f.putImageData(n,0,0),n},s=document.getElementById("filter3"),s.addEventListener("click",w),E=function(){var t,e,a,n,r,i;for(n=f.createImageData(j.width,j.height),r=n.data,t=[.373412,.347019,.3914],e=a=0,i=u.length;a<i;e=a+=4)r[e]=255/(1+Math.exp(t[0]*(127-u[e]))),r[e+1]=255/(1+Math.exp(t[1]*(127-u[e+1]))),r[e+2]=255/(1+Math.exp(t[2]*(127-u[e+2]))),r[e+3]=u[e+3];return f.putImageData(n,0,0),n},D=document.getElementById("filter4"),D.addEventListener("click",E),M=function(){var t,e,a,n,r,i;for(n=f.createImageData(j.width,j.height),r=n.data,t=[.0073412,.647019,.7914],e=a=0,i=u.length;a<i;e=a+=4)r[e]=255/(1+Math.exp(t[0]*(127-u[e]))),r[e+1]=255/(1+Math.exp(t[1]*(127-u[e+1]))),r[e+2]=255/(1+Math.exp(t[2]*(127-u[e+2]))),r[e+3]=u[e+3];return f.putImageData(n,0,0),n},y=document.getElementById("filter5"),y.addEventListener("click",M),k=function(){var t,e,a,n,r,i;for(n=f.createImageData(j.width,j.height),r=n.data,t=[.93412,.647019,.0057914],e=a=0,i=u.length;a<i;e=a+=4)r[e]=255/(1+Math.exp(t[0]*(127-u[e]))),r[e+1]=255/(1+Math.exp(t[1]*(127-u[e+1]))),r[e+2]=255/(1+Math.exp(t[2]*(127-u[e+2]))),r[e+3]=u[e+3];return f.putImageData(n,0,0),n},B=document.getElementById("filter6"),B.addEventListener("click",k),$=function(t){var e,a,n,r,i,o,d,h,c,g,m,l,I,p,v,w,s,E,D,M,y,k,B,L,x,_,b,z,R,U,A,C,F;for(null==t&&(t=5),w=f.createImageData(j.width,j.height),s=w.data,"number"!=typeof t&&(t=5),C=t,p=256/C,o=255/(C-1),n=function(){var t,e;for(e=[],t=1;t<=256;t++)e.push(0);return e}(),d=c=0,M=C;0<=M?c<M:c>M;d=0<=M?++c:--c)for(h=g=y=Math.floor(d*p),k=Math.floor((d+1)*p);y<=k?g<k:g>k;h=y<=k?++g:--g)n[h]=o*d;for(A=t,I=256/A,i=255/(A-1),a=function(){var t,e;for(e=[],t=1;t<=256;t++)e.push(0);return e}(),d=m=0,B=A;0<=B?m<B:m>B;d=0<=B?++m:--m)for(h=v=L=Math.floor(d*I),x=Math.floor((d+1)*I);L<=x?v<x:v>x;h=L<=x?++v:--v)a[h]=i*d;for(U=t,l=256/U,r=255/(U-1),e=function(){var t,e;for(e=[],t=1;t<=256;t++)e.push(0);return e}(),d=E=0,_=U;0<=_?E<_:E>_;d=0<=_?++E:--E)for(h=D=b=Math.floor(d*l),z=Math.floor((d+1)*l);b<=z?D<z:D>z;h=b<=z?++D:--D)e[h]=r*d;for(d=F=0,R=u.length;F<R;d=F+=4)s[d]=n[u[d]],s[d+1]=a[u[d+1]],s[d+2]=e[u[d+2]],s[d+3]=u[d+3];return f.putImageData(w,0,0),w},tt=document.getElementById("posterization"),tt.addEventListener("click",$),K=function(){var t,e,a,n,r,i,o,d,h,c,g,m,l,I,p,v,w;for(h=f.createImageData(j.width,j.height),c=h.data,w=r=1,g=j.height-1;1<=g?r<g:r>g;w=1<=g?++r:--r)for(v=i=1,m=j.width-1;1<=m?i<m:i>m;v=1<=m?++i:--i){for(n=4*(w*j.width+v),p=[],I=[],l=[],a=o=-1;o<=1;a=++o)for(e=d=-1;d<=1;e=++d)t=4*((w+a)*j.width+(v+e)),p.push(u[t]),I.push(u[t+1]),l.push(u[t+2]);p.sort(function(t,e){return t>e?-1:t<e?1:0}),I.sort(function(t,e){return t>e?-1:t<e?1:0}),l.sort(function(t,e){return t>e?-1:t<e?1:0}),c[n]=p[4],c[n+1]=I[4],c[n+2]=l[4],c[n+3]=u[n+3]}return f.putImageData(h,0,0),h},N=document.getElementById("median_filter"),N.addEventListener("click",K),q=function(){var t,e,a,n,r,i,o,d,h,c,g,m,l,I,p,v,w,s,E,D,M,y,k,B,L;for(v=$(64),w=v.data,L=h=2,E=j.height-2;2<=E?h<E:h>E;L=2<=E?++h:--h)for(B=c=2,D=j.width-2;2<=D?c<D:c>D;B=2<=D?++c:--c){for(o=4*(L*j.width+B),i=function(){var t,e;for(e=[],t=1;t<=256;t++)e.push(0);return e}(),r=function(){var t,e;for(e=[],t=1;t<=256;t++)e.push(0);return e}(),n=function(){var t,e;for(e=[],t=1;t<=256;t++)e.push(0);return e}(),a=I=-2;I<=2;a=++I)for(e=p=-2;p<=2;e=++p)t=4*((L+a)*j.width+(B+e)),i[u[t]]+=1,r[u[t+1]]+=1,n[u[t+2]]+=1;for(l=0,m=0,g=0,k=0,y=0,M=0,d=s=0;s<=255;d=++s)l<i[d]&&(l=i[d],k=d),m<r[d]&&(m=r[d],y=d),g<n[d]&&(g=n[d],M=d);w[o]=k,w[o+1]=y,w[o+2]=M,w[o+3]=u[o+3]}return f.putImageData(v,0,0),v},G=document.getElementById("kaiga"),G.addEventListener("click",q),L=function(){var t,e,a,n,r,i,o,d,h,c,g,m,l,I,p,v,w,s,E;for(m=f.createImageData(j.width,j.height),l=m.data,t=[1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9],E=d=2,p=j.height;2<=p?d<p:d>p;E=2<=p?++d:--d)for(s=h=2,v=j.width;2<=v?h<v:h>v;s=2<=v?++h:--h){for(i=4*(E*j.width+s),w=[0,0,0],r=c=-2;c<=0;r=++c)for(n=g=-2;g<=0;n=++g)for(o=3*(r+2)+(n+2),a=4*((E+r)*j.width+(s+n)),e=I=0;I<3;e=++I)w[e]+=u[a+e]*t[o];l[i]=w[0],l[i+1]=w[1],l[i+2]=w[2],l[i+3]=u[i+3]}return f.putImageData(m,0,0),m},x=document.getElementById("fir_filter"),x.addEventListener("click",L),_=function(){var t,e,a,n,r,i;for(n=U(),r=n.data,a=255,_=1.5,t=e=0,i=r.length;e<i;t=e+=4)r[t]=a*Math.pow(u[t]/a,1/_),r[t+1]=a*Math.pow(u[t+1]/a,1/_),r[t+2]=a*Math.pow(u[t+2]/a,1/_),r[t+3]=r[t+3];f.putImageData(n,0,0)},b=document.getElementById("gamma"),b.addEventListener("click",_),et=function(){var t,e,a,n,r,i,o,d,h,c,g;for(d=U(),h=d.data,n=r=0,g=u.length;r<g;n=r+=4){for(c=u[n],e=u[n+1],t=u[n+2],i=Math.max(c,e,t),o=Math.min(c,e,t),c===e&&c===t?a=0:c>=e&&c>=t?a=60*((e-t)/(i-o)):e>=c&&e>=t?a=60*((t-c)/(i-o))+120:t>=c&&t>=e&&(a=60*((c-e)/(i-o))+240);a<0;)a+=360;(a<=30||a>=300)&&(h[n]=c,h[n+1]=e,h[n+2]=t)}return f.putImageData(d,0,0),d},at=document.getElementById("red"),at.addEventListener("click",et),C=function(){var t,e,a,n,r,i,o,d,h,c,g;for(d=U(),h=d.data,n=r=0,g=u.length;r<g;n=r+=4){for(c=u[n],e=u[n+1],t=u[n+2],i=Math.max(c,e,t),o=Math.min(c,e,t),c===e&&c===t?a=0:c>=e&&c>=t?a=60*((e-t)/(i-o)):e>=c&&e>=t?a=60*((t-c)/(i-o))+120:t>=c&&t>=e&&(a=60*((c-e)/(i-o))+240);a<0;)a+=360;a<=180&&a>=30&&(h[n]=c,h[n+1]=e,h[n+2]=t)}return f.putImageData(d,0,0),d},F=document.getElementById("green"),F.addEventListener("click",C),n=function(){var t,e,a,n,r,i,o,d,h,c,g;for(d=U(),h=d.data,n=r=0,g=u.length;r<g;n=r+=4){for(c=u[n],e=u[n+1],t=u[n+2],i=Math.max(c,e,t),o=Math.min(c,e,t),c===e&&c===t?a=0:c>=e&&c>=t?a=60*((e-t)/(i-o)):e>=c&&e>=t?a=60*((t-c)/(i-o))+120:t>=c&&t>=e&&(a=60*((c-e)/(i-o))+240);a<0;)a+=360;a<=300&&a>=180&&(h[n]=c,h[n+1]=e,h[n+2]=t)}return f.putImageData(d,0,0),d},r=document.getElementById("blue"),r.addEventListener("click",n),dt=function(){var t,e,a,n,r,i,o,d,h,c,g,m,l,I,p,v,w,s,E,D,M,y,k,B,L,x,_,b,z,R,A,C,F,j;for(v=U(),w=v.data,"number"!=typeof R&&(R=5),F=R,I=256/F,i=255/(F-1),a=function(){var t,e;for(e=[],t=1;t<=256;t++)e.push(0);return e}(),o=h=0,D=F;0<=D?h<D:h>D;o=0<=D?++h:--h)for(d=c=M=Math.floor(o*I),y=Math.floor((o+1)*I);M<=y?c<y:c>y;d=M<=y?++c:--c)a[d]=i*o;for(C=R,l=256/C,r=255/(C-1),e=function(){var t,e;for(e=[],t=1;t<=256;t++)e.push(0);return e}(),o=g=0,k=C;0<=k?g<k:g>k;o=0<=k?++g:--g)for(d=p=B=Math.floor(o*l),L=Math.floor((o+1)*l);B<=L?p<L:p>L;d=B<=L?++p:--p)e[d]=r*o;for(A=R,m=256/A,n=255/(A-1),t=function(){var t,e;for(e=[],t=1;t<=256;t++)e.push(0);return e}(),o=s=0,x=A;0<=x?s<x:s>x;o=0<=x?++s:--s)for(d=E=_=Math.floor(o*m),b=Math.floor((o+1)*m);_<=b?E<b:E>b;d=_<=b?++E:--E)t[d]=n*o;for(o=j=0,z=u.length;j<z;o=j+=4)w[o]=a[w[o]],w[o+1]=e[w[o+1]],w[o+2]=t[w[o+2]],w[o+3]=w[o+3];return f.putImageData(v,0,0),v},ht=document.getElementById("simple"),ht.addEventListener("click",dt)},window.onload=function(){var e,a;e=document.getElementById("preview"),a=document.getElementById("getfile"),a.onchange=function(){var e,n;e=new Image,e.onload=function(){t(this)},n=new FileReader,n.onload=function(){return e.src=n.result},n.readAsDataURL(a.files[0])}}}).call(this);